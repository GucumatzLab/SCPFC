<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
  <f:metadata>
    <f:viewAction if="#{not sesionActiva.esAdministrador}"
                  action="#{sesionActiva.redirigeAPaginaPrincipal}" />
  </f:metadata>

  <ui:composition template="WEB-INF/plantilla.xhtml">
    <ui:define name="titulo">Agregar Puesto</ui:define>

    <ui:define name="contenido">
      <h1>Registro de nuevo Puesto</h1> 

      <h:form id="myForm">
        <table>
          <tr>
            <td><h:outputText value="Nombre de Puesto : "/></td>
            <td><p:inputText value="#{agregadorPuesto.puesto.nombre}" required="true" id="NombrePuesto"/></td>
          </tr>
          <tr>
            <td><h:outputText value="Tipo de Comida : "/></td>
            <td><p:inputText value="#{agregadorPuesto.puesto.tipoComida}" required="true" id="TipoComida"/></td>
          </tr>
          <tr>
            <td><h:outputText value="Referencias (opcional): "/></td>
            <td><p:inputText value="#{agregadorPuesto.puesto.referencias}"/></td>
          </tr>
          <tr>
            <td>
              <p:commandButton value="Localizar" type="button" onclick="PF('dlg1').show();"/>
              <p:dialog header="Localizando" widgetVar="dlg1" height="400" width="400">
                <p:gmap id="gmap" center="19.324328359583355,-99.17934268712997" zoom="18"
                        type="HYBRID" model="#{mapa.advancedModel}" onPointClick="handlePointClick2(event)"
                        style="width:100%;height:100%" 
                        widgetVar="map">
                </p:gmap>
                <h:inputHidden id ="lng" value ="#{agregadorPuesto.puesto.longitud}" required="true" />
                <h:inputHidden id ="lat" value="#{agregadorPuesto.puesto.latitud}" required="true" />
                <center>
                  <p:commandButton value ="Hecho" onclick="PF('dlg1').hide()"/>
                </center>
              </p:dialog>
            </td>
          </tr>
          <tr>
            <td colspan="2" align="center">
              <p:commandButton action="#{agregadorPuesto.agrega()}" value="Agregar"/>
              <p:commandButton value="Reset" update="myForm" process="@this"  >
                <p:resetInput target="myForm" />
              </p:commandButton>
            </td>
          </tr>
        </table>
        <table>
          <tr>
            <td><p:messages id="messages" autoUpdate="true" closable="true" /></td>
          </tr>
        </table>
      </h:form>

      <script type="text/javascript">
        function handlePointClick2(event) {
          document.getElementById("myForm:lat").value = event.latLng.lat();
          document.getElementById("myForm:lng").value = event.latLng.lng();
        }
      </script>
    </ui:define>
  </ui:composition>
</html>
